(self["webpackChunkrspack_repro"] = self["webpackChunkrspack_repro"] || []).push([["node_modules_pnpm_yargs-parser_21_1_1_node_modules_yargs-parser_build_sync_recursive-node_mod-eea58f"],{

/***/ "./node_modules/.pnpm/yargs-parser@21.1.1/node_modules/yargs-parser/build sync recursive":
/*!**************************************************************************************!*\
  !*** ./node_modules/.pnpm/yargs-parser@21.1.1/node_modules/yargs-parser/build/ sync ***!
  \**************************************************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "./node_modules/.pnpm/yargs-parser@21.1.1/node_modules/yargs-parser/build sync recursive";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "./node_modules/.pnpm/yargs@17.3.1/node_modules/yargs/build sync recursive":
/*!************************************************************************!*\
  !*** ./node_modules/.pnpm/yargs@17.3.1/node_modules/yargs/build/ sync ***!
  \************************************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "./node_modules/.pnpm/yargs@17.3.1/node_modules/yargs/build sync recursive";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "./node_modules/.pnpm/yargs@17.3.1/node_modules/yargs sync recursive":
/*!******************************************************************!*\
  !*** ./node_modules/.pnpm/yargs@17.3.1/node_modules/yargs/ sync ***!
  \******************************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "./node_modules/.pnpm/yargs@17.3.1/node_modules/yargs sync recursive";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "./src/core/i18n/collect-ui-strings.js":
/*!*********************************************!*\
  !*** ./src/core/i18n/collect-ui-strings.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

// Copyright 2022 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

const glob = __webpack_require__(/*! glob */ "./node_modules/.pnpm/glob@7.1.7/node_modules/glob/glob.js");
const path = __webpack_require__(Object(function webpackMissingModule() { var e = new Error("Cannot find module 'path'"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));

const {collectAllStringsInDir, createPsuedoLocaleStrings, IGNORED_PATH_COMPONENTS} =
    __webpack_require__(Object(function webpackMissingModule() { var e = new Error("Cannot find module '../../../third_party/i18n/collect-strings.js'"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));
const {bakePlaceholders} = __webpack_require__(Object(function webpackMissingModule() { var e = new Error("Cannot find module '../../../third_party/i18n/bake-ctc-to-lhl.js'"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));
const {writeIfChanged} = __webpack_require__(Object(function webpackMissingModule() { var e = new Error("Cannot find module '../../../scripts/build/ninja/write-if-changed.js'"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));

/** @typedef {import('../../../third_party/i18n/bake-ctc-to-lhl.js').CtcMessage} CtcMessage */

const yargsObject = (__webpack_require__(/*! yargs */ "./node_modules/.pnpm/yargs@17.3.1/node_modules/yargs/index.cjs").option)('input-directories', {
                          type: 'array',
                          demandOption: true,
                        })
                        .option('output-directory', {
                          type: 'string',
                          demandOption: true,
                        })
                        .option('include-en-xl', {
                          type: 'boolean',
                        })
                        .strict()
                        .argv;

/**
 * @param {string} outputDirectory
 * @param {string} locale
 * @param {Record<string, CtcMessage>} strings
 */
function convertCtcToLhLAndSave(outputDirectory, locale, strings) {
  const outputPath = path.join(outputDirectory, `${locale}.json`);

  /** @type {Record<string, CtcMessage>} */
  const sortedCtcStrings = {};
  const sortedEntries = Object.entries(strings).sort(([keyA], [keyB]) => keyA.localeCompare(keyB));
  for (const [key, defn] of sortedEntries) {
    sortedCtcStrings[key] = defn;
  }

  const convertedStrings = bakePlaceholders(sortedCtcStrings);
  writeIfChanged(outputPath, JSON.stringify(convertedStrings, null, 2) + '\n');
}

const inputDirectories = yargsObject['input-directories'];
if (inputDirectories.length === 0) {
  throw new Error('Provide at least one directory!');
}

/** @type {Record<string, CtcMessage>} */
let collectedStrings = {};
/** @type {string[]} */
const files = [];
for (const directory of inputDirectories) {
  collectedStrings = {
    ...collectedStrings,
    ...collectAllStringsInDir(directory),
  };

  const fs = glob.sync('**/*.{js,ts,gn}', {
    cwd: directory,
    ignore: IGNORED_PATH_COMPONENTS,
  });
  files.push(...fs.map(f => path.join(directory, f)));
}

const outputDirectory = yargsObject['output-directory'];
convertCtcToLhLAndSave(outputDirectory, 'en-US', collectedStrings);
if (yargsObject['include-en-xl']) {
  convertCtcToLhLAndSave(outputDirectory, 'en-XL', createPsuedoLocaleStrings(collectedStrings));
}

// Write the depfile. This is necessary to properly rebuild en-US.json/en-XL.json
// when any of the input TS files change. We also re-build when any GN file changes,
// since new TS/JS files might have been added.
const depfile = `
${path.join(outputDirectory, 'en-US.json')}: ${files.join(' ')}
`;

writeIfChanged(path.join(outputDirectory, 'collected-ui-strings.d'), depfile);


/***/ })

}]);