"use strict";
(self["webpackChunk"] = self["webpackChunk"] || []).push([["third_party_csp_evaluator_package_checks_security_checks_js"],{

/***/ "./third_party/csp_evaluator/package/allowlist_bypasses/angular.js":
/*!*************************************************************************!*\
  !*** ./third_party/csp_evaluator/package/allowlist_bypasses/angular.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   URLS: () => (/* binding */ URLS)
/* harmony export */ });
/**
 * @fileoverview Collection of popular sites/CDNs hosting Angular.
 * @author lwe@google.com (Lukas Weichselbaum)
 *
 * @license
 * Copyright 2016 Google Inc. All rights reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * Angular libraries on commonly allowlisted origins (e.g. CDNs) that would
 * allow a CSP bypass.
 * Only most common paths are listed here. Hence there might still be other
 * paths on these domains that would allow a bypass.
 */
const URLS = [
    '//gstatic.com/fsn/angular_js-bundle1.js',
    '//www.gstatic.com/fsn/angular_js-bundle1.js',
    '//www.googleadservices.com/pageadimg/imgad',
    '//yandex.st/angularjs/1.2.16/angular-cookies.min.js',
    '//yastatic.net/angularjs/1.2.23/angular.min.js',
    '//yuedust.yuedu.126.net/js/components/angular/angular.js',
    '//art.jobs.netease.com/script/angular.js',
    '//csu-c45.kxcdn.com/angular/angular.js',
    '//elysiumwebsite.s3.amazonaws.com/uploads/blog-media/rockstar/angular.min.js',
    '//inno.blob.core.windows.net/new/libs/AngularJS/1.2.1/angular.min.js',
    '//gift-talk.kakao.com/public/javascripts/angular.min.js',
    '//ajax.googleapis.com/ajax/libs/angularjs/1.2.0rc1/angular-route.min.js',
    '//master-sumok.ru/vendors/angular/angular-cookies.js',
    '//ayicommon-a.akamaihd.net/static/vendor/angular-1.4.2.min.js',
    '//pangxiehaitao.com/framework/angular-1.3.9/angular-animate.min.js',
    '//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.16/angular.min.js',
    '//96fe3ee995e96e922b6b-d10c35bd0a0de2c718b252bc575fdb73.ssl.cf1.rackcdn.com/angular.js',
    '//oss.maxcdn.com/angularjs/1.2.20/angular.min.js',
    '//reports.zemanta.com/smedia/common/angularjs/1.2.11/angular.js',
    '//cdn.shopify.com/s/files/1/0225/6463/t/1/assets/angular-animate.min.js',
    '//parademanagement.com.s3-website-ap-southeast-1.amazonaws.com/js/angular.min.js',
    '//cdn.jsdelivr.net/angularjs/1.1.2/angular.min.js',
    '//eb2883ede55c53e09fd5-9c145fb03d93709ea57875d307e2d82e.ssl.cf3.rackcdn.com/components/angular-resource.min.js',
    '//andors-trail.googlecode.com/git/AndorsTrailEdit/lib/angular.min.js',
    '//cdn.walkme.com/General/EnvironmentTests/angular/angular.min.js',
    '//laundrymail.com/angular/angular.js',
    '//s3-eu-west-1.amazonaws.com/staticancpa/js/angular-cookies.min.js',
    '//collade.demo.stswp.com/js/vendor/angular.min.js',
    '//mrfishie.github.io/sailor/bower_components/angular/angular.min.js',
    '//askgithub.com/static/js/angular.min.js',
    '//services.amazon.com/solution-providers/assets/vendor/angular-cookies.min.js',
    '//raw.githubusercontent.com/angular/code.angularjs.org/master/1.0.7/angular-resource.js',
    '//prb-resume.appspot.com/bower_components/angular-animate/angular-animate.js',
    '//dl.dropboxusercontent.com/u/30877786/angular.min.js',
    '//static.tumblr.com/x5qdx0r/nPOnngtff/angular-resource.min_1_.js',
    '//storage.googleapis.com/assets-prod.urbansitter.net/us-sym/assets/vendor/angular-sanitize/angular-sanitize.min.js',
    '//twitter.github.io/labella.js/bower_components/angular/angular.min.js',
    '//cdn2-casinoroom.global.ssl.fastly.net/js/lib/angular-animate.min.js',
    '//www.adobe.com/devnet-apps/flashshowcase/lib/angular/angular.1.1.5.min.js',
    '//eternal-sunset.herokuapp.com/bower_components/angular/angular.js',
    '//cdn.bootcss.com/angular.js/1.2.0/angular.min.js'
];
//# sourceMappingURL=angular.js.map

/***/ }),

/***/ "./third_party/csp_evaluator/package/allowlist_bypasses/flash.js":
/*!***********************************************************************!*\
  !*** ./third_party/csp_evaluator/package/allowlist_bypasses/flash.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   URLS: () => (/* binding */ URLS)
/* harmony export */ });
/**
 * @fileoverview Collection of popular sites/CDNs hosting flash with user
 * provided JS.
 * @author lwe@google.com (Lukas Weichselbaum)
 *
 * @license
 * Copyright 2016 Google Inc. All rights reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * Domains that would allow a CSP bypass if allowlisted.
 * Only most common paths will be listed here. Hence there might still be other
 * paths on these domains that would allow a bypass.
 */
const URLS = [
    '//vk.com/swf/video.swf',
    '//ajax.googleapis.com/ajax/libs/yui/2.8.0r4/build/charts/assets/charts.swf'
];
//# sourceMappingURL=flash.js.map

/***/ }),

/***/ "./third_party/csp_evaluator/package/allowlist_bypasses/jsonp.js":
/*!***********************************************************************!*\
  !*** ./third_party/csp_evaluator/package/allowlist_bypasses/jsonp.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   NEEDS_EVAL: () => (/* binding */ NEEDS_EVAL),
/* harmony export */   URLS: () => (/* binding */ URLS)
/* harmony export */ });
/**
 * @fileoverview Collection of popular sites/CDNs hosting JSONP-like endpoints.
 * Endpoints don't contain necessary parameters to trigger JSONP response
 * because parameters are ignored in CSP allowlists.
 * Usually per domain only one (popular) file path is listed to allow bypasses
 * of the most common path based allowlists. It's not practical to ship a list
 * for all possible paths/domains. Therefore the jsonp bypass check usually only
 * works efficient for domain based allowlists.
 * @author lwe@google.com (Lukas Weichselbaum)
 *
 * @license
 * Copyright 2016 Google Inc. All rights reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * Some JSONP-like bypasses only work if the CSP allows 'eval()'.
 */
const NEEDS_EVAL = [
    'googletagmanager.com', 'www.googletagmanager.com',
    'www.googleadservices.com', 'google-analytics.com',
    'ssl.google-analytics.com', 'www.google-analytics.com'
];
/**
 * JSONP endpoints on commonly allowlisted origins (e.g. CDNs) that would allow
 * a CSP bypass.
 * Only most common paths are listed here. Hence there might still be other
 * paths on these domains that would allow a bypass.
 */
const URLS = [
    '//bebezoo.1688.com/fragment/index.htm',
    '//www.google-analytics.com/gtm/js',
    '//googleads.g.doubleclick.net/pagead/conversion/1036918760/wcm',
    '//www.googleadservices.com/pagead/conversion/1070110417/wcm',
    '//www.google.com/tools/feedback/escalation-options',
    '//pin.aliyun.com/check_audio',
    '//offer.alibaba.com/market/CID100002954/5/fetchKeyword.do',
    '//ccrprod.alipay.com/ccr/arriveTime.json',
    '//group.aliexpress.com/ajaxAcquireGroupbuyProduct.do',
    '//detector.alicdn.com/2.7.3/index.php',
    '//suggest.taobao.com/sug',
    '//translate.google.com/translate_a/l',
    '//count.tbcdn.cn//counter3',
    '//wb.amap.com/channel.php',
    '//translate.googleapis.com/translate_a/l',
    '//afpeng.alimama.com/ex',
    '//accounts.google.com/o/oauth2/revoke',
    '//pagead2.googlesyndication.com/relatedsearch',
    '//yandex.ru/soft/browsers/check',
    '//api.facebook.com/restserver.php',
    '//mts0.googleapis.com/maps/vt',
    '//syndication.twitter.com/widgets/timelines/765840589183213568',
    '//www.youtube.com/profile_style',
    '//googletagmanager.com/gtm/js',
    '//mc.yandex.ru/watch/24306916/1',
    '//share.yandex.net/counter/gpp/',
    '//ok.go.mail.ru/lady_on_lady_recipes_r.json',
    '//d1f69o4buvlrj5.cloudfront.net/__efa_15_1_ornpba.xekq.arg/optout_check',
    '//www.googletagmanager.com/gtm/js',
    '//api.vk.com/method/wall.get',
    '//www.sharethis.com/get-publisher-info.php',
    '//google.ru/maps/vt',
    '//pro.netrox.sc/oapi/h_checksite.ashx',
    '//vimeo.com/api/oembed.json/',
    '//de.blog.newrelic.com/wp-admin/admin-ajax.php',
    '//ajax.googleapis.com/ajax/services/search/news',
    '//ssl.google-analytics.com/gtm/js',
    '//pubsub.pubnub.com/subscribe/demo/hello_world/',
    '//pass.yandex.ua/services',
    '//id.rambler.ru/script/topline_info.js',
    '//m.addthis.com/live/red_lojson/100eng.json',
    '//passport.ngs.ru/ajax/check',
    '//catalog.api.2gis.ru/ads/search',
    '//gum.criteo.com/sync',
    '//maps.google.com/maps/vt',
    '//ynuf.alipay.com/service/um.json',
    '//securepubads.g.doubleclick.net/gampad/ads',
    '//c.tiles.mapbox.com/v3/texastribune.tx-congress-cvap/6/15/26.grid.json',
    '//rexchange.begun.ru/banners',
    '//an.yandex.ru/page/147484',
    '//links.services.disqus.com/api/ping',
    '//api.map.baidu.com/',
    '//tj.gongchang.com/api/keywordrecomm/',
    '//data.gongchang.com/livegrail/',
    '//ulogin.ru/token.php',
    '//beta.gismeteo.ru/api/informer/layout.js/120x240-3/ru/',
    '//maps.googleapis.com/maps/api/js/GeoPhotoService.GetMetadata',
    '//a.config.skype.com/config/v1/Skype/908_1.33.0.111/SkypePersonalization',
    '//maps.beeline.ru/w',
    '//target.ukr.net/',
    '//www.meteoprog.ua/data/weather/informer/Poltava.js',
    '//cdn.syndication.twimg.com/widgets/timelines/599200054310604802',
    '//wslocker.ru/client/user.chk.php',
    '//community.adobe.com/CommunityPod/getJSON',
    '//maps.google.lv/maps/vt',
    '//dev.virtualearth.net/REST/V1/Imagery/Metadata/AerialWithLabels/26.318581',
    '//awaps.yandex.ru/10/8938/02400400.',
    '//a248.e.akamai.net/h5.hulu.com/h5.mp4',
    '//nominatim.openstreetmap.org/',
    '//plugins.mozilla.org/en-us/plugins_list.json',
    '//h.cackle.me/widget/32153/bootstrap',
    '//graph.facebook.com/1/',
    '//fellowes.ugc.bazaarvoice.com/data/reviews.json',
    '//widgets.pinterest.com/v3/pidgets/boards/ciciwin/hedgehog-squirrel-crafts/pins/',
    '//www.linkedin.com/countserv/count/share',
    '//se.wikipedia.org/w/api.php',
    '//cse.google.com/api/007627024705277327428/cse/r3vs7b0fcli/queries/js',
    '//relap.io/api/v2/similar_pages_jsonp.js',
    '//c1n3.hypercomments.com/stream/subscribe',
    '//maps.google.de/maps/vt',
    '//books.google.com/books',
    '//connect.mail.ru/share_count',
    '//tr.indeed.com/m/newjobs',
    '//www-onepick-opensocial.googleusercontent.com/gadgets/proxy',
    '//www.panoramio.com/map/get_panoramas.php',
    '//client.siteheart.com/streamcli/client',
    '//www.facebook.com/restserver.php',
    '//autocomplete.travelpayouts.com/avia',
    '//www.googleapis.com/freebase/v1/topic/m/0344_',
    '//mts1.googleapis.com/mapslt/ft',
    '//api.twitter.com/1/statuses/oembed.json',
    '//fast.wistia.com/embed/medias/o75jtw7654.json',
    '//partner.googleadservices.com/gampad/ads',
    '//pass.yandex.ru/services',
    '//gupiao.baidu.com/stocks/stockbets',
    '//widget.admitad.com/widget/init',
    '//api.instagram.com/v1/tags/partykungen23328/media/recent',
    '//video.media.yql.yahoo.com/v1/video/sapi/streams/063fb76c-6c70-38c5-9bbc-04b7c384de2b',
    '//ib.adnxs.com/jpt',
    '//pass.yandex.com/services',
    '//www.google.de/maps/vt',
    '//clients1.google.com/complete/search',
    '//api.userlike.com/api/chat/slot/proactive/',
    '//www.youku.com/index_cookielist/s/jsonp',
    '//mt1.googleapis.com/mapslt/ft',
    '//api.mixpanel.com/track/',
    '//wpd.b.qq.com/cgi/get_sign.php',
    '//pipes.yahooapis.com/pipes/pipe.run',
    '//gdata.youtube.com/feeds/api/videos/WsJIHN1kNWc',
    '//9.chart.apis.google.com/chart',
    '//cdn.syndication.twitter.com/moments/709229296800440320',
    '//api.flickr.com/services/feeds/photos_friends.gne',
    '//cbks0.googleapis.com/cbk',
    '//www.blogger.com/feeds/5578653387562324002/posts/summary/4427562025302749269',
    '//query.yahooapis.com/v1/public/yql',
    '//kecngantang.blogspot.com/feeds/posts/default/-/Komik',
    '//www.travelpayouts.com/widgets/50f53ce9ada1b54bcc000031.json',
    '//i.cackle.me/widget/32586/bootstrap',
    '//translate.yandex.net/api/v1.5/tr.json/detect',
    '//a.tiles.mapbox.com/v3/zentralmedia.map-n2raeauc.jsonp',
    '//maps.google.ru/maps/vt',
    '//c1n2.hypercomments.com/stream/subscribe',
    '//rec.ydf.yandex.ru/cookie',
    '//cdn.jsdelivr.net'
];
//# sourceMappingURL=jsonp.js.map

/***/ }),

/***/ "./third_party/csp_evaluator/package/checks/security_checks.js":
/*!*********************************************************************!*\
  !*** ./third_party/csp_evaluator/package/checks/security_checks.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DIRECTIVES_CAUSING_XSS: () => (/* binding */ DIRECTIVES_CAUSING_XSS),
/* harmony export */   URL_SCHEMES_CAUSING_XSS: () => (/* binding */ URL_SCHEMES_CAUSING_XSS),
/* harmony export */   checkDeprecatedDirective: () => (/* binding */ checkDeprecatedDirective),
/* harmony export */   checkFlashObjectAllowlistBypass: () => (/* binding */ checkFlashObjectAllowlistBypass),
/* harmony export */   checkHasConfiguredReporting: () => (/* binding */ checkHasConfiguredReporting),
/* harmony export */   checkIpSource: () => (/* binding */ checkIpSource),
/* harmony export */   checkMissingBaseUriDirective: () => (/* binding */ checkMissingBaseUriDirective),
/* harmony export */   checkMissingDirectives: () => (/* binding */ checkMissingDirectives),
/* harmony export */   checkMissingObjectSrcDirective: () => (/* binding */ checkMissingObjectSrcDirective),
/* harmony export */   checkMissingScriptSrcDirective: () => (/* binding */ checkMissingScriptSrcDirective),
/* harmony export */   checkMultipleMissingBaseUriDirective: () => (/* binding */ checkMultipleMissingBaseUriDirective),
/* harmony export */   checkNonceLength: () => (/* binding */ checkNonceLength),
/* harmony export */   checkPlainUrlSchemes: () => (/* binding */ checkPlainUrlSchemes),
/* harmony export */   checkScriptAllowlistBypass: () => (/* binding */ checkScriptAllowlistBypass),
/* harmony export */   checkScriptUnsafeEval: () => (/* binding */ checkScriptUnsafeEval),
/* harmony export */   checkScriptUnsafeInline: () => (/* binding */ checkScriptUnsafeInline),
/* harmony export */   checkSrcHttp: () => (/* binding */ checkSrcHttp),
/* harmony export */   checkWildcards: () => (/* binding */ checkWildcards),
/* harmony export */   looksLikeIpAddress: () => (/* binding */ looksLikeIpAddress)
/* harmony export */ });
/* harmony import */ var _allowlist_bypasses_angular_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../allowlist_bypasses/angular.js */ "./third_party/csp_evaluator/package/allowlist_bypasses/angular.js");
/* harmony import */ var _allowlist_bypasses_flash_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../allowlist_bypasses/flash.js */ "./third_party/csp_evaluator/package/allowlist_bypasses/flash.js");
/* harmony import */ var _allowlist_bypasses_jsonp_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../allowlist_bypasses/jsonp.js */ "./third_party/csp_evaluator/package/allowlist_bypasses/jsonp.js");
/* harmony import */ var _csp_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../csp.js */ "./third_party/csp_evaluator/package/csp.js");
/* harmony import */ var _finding_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../finding.js */ "./third_party/csp_evaluator/package/finding.js");
/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils.js */ "./third_party/csp_evaluator/package/utils.js");
/**
 * @fileoverview Collection of CSP evaluation checks.
 * @author lwe@google.com (Lukas Weichselbaum)
 *
 * @license
 * Copyright 2016 Google Inc. All rights reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */







/**
 * A list of CSP directives that can allow XSS vulnerabilities if they fail
 * validation.
 */
const DIRECTIVES_CAUSING_XSS = [_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.SCRIPT_SRC, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.OBJECT_SRC, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.BASE_URI];
/**
 * A list of URL schemes that can allow XSS vulnerabilities when requests to
 * them are made.
 */
const URL_SCHEMES_CAUSING_XSS = ['data:', 'http:', 'https:'];
/**
 * Checks if passed csp allows inline scripts.
 * Findings of this check are critical and FP free.
 * unsafe-inline is ignored in the presence of a nonce or a hash. This check
 * does not account for this and therefore the effectiveCsp needs to be passed.
 *
 * Example policy where this check would trigger:
 *  script-src 'unsafe-inline'
 *
 * @param effectiveCsp A parsed csp that only contains values which
 *  are active in a certain version of CSP (e.g. no unsafe-inline if a nonce
 *  is present).
 */
function checkScriptUnsafeInline(effectiveCsp) {
    const directiveName = effectiveCsp.getEffectiveDirective(_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.SCRIPT_SRC);
    const values = effectiveCsp.directives[directiveName] || [];
    // Check if unsafe-inline is present.
    if (values.includes(_csp_js__WEBPACK_IMPORTED_MODULE_3__.Keyword.UNSAFE_INLINE)) {
        return [new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.SCRIPT_UNSAFE_INLINE, `'unsafe-inline' allows the execution of unsafe in-page scripts ` +
                'and event handlers.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.HIGH, directiveName, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Keyword.UNSAFE_INLINE)];
    }
    return [];
}
/**
 * Checks if passed csp allows eval in scripts.
 * Findings of this check have a medium severity and are FP free.
 *
 * Example policy where this check would trigger:
 *  script-src 'unsafe-eval'
 *
 * @param parsedCsp Parsed CSP.
 */
function checkScriptUnsafeEval(parsedCsp) {
    const directiveName = parsedCsp.getEffectiveDirective(_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.SCRIPT_SRC);
    const values = parsedCsp.directives[directiveName] || [];
    // Check if unsafe-eval is present.
    if (values.includes(_csp_js__WEBPACK_IMPORTED_MODULE_3__.Keyword.UNSAFE_EVAL)) {
        return [new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.SCRIPT_UNSAFE_EVAL, `'unsafe-eval' allows the execution of code injected into DOM APIs ` +
                'such as eval().', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.MEDIUM_MAYBE, directiveName, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Keyword.UNSAFE_EVAL)];
    }
    return [];
}
/**
 * Checks if plain URL schemes (e.g. http:) are allowed in sensitive directives.
 * Findings of this check have a high severity and are FP free.
 *
 * Example policy where this check would trigger:
 *  script-src https: http: data:
 *
 * @param parsedCsp Parsed CSP.
 */
function checkPlainUrlSchemes(parsedCsp) {
    const violations = [];
    const directivesToCheck = parsedCsp.getEffectiveDirectives(DIRECTIVES_CAUSING_XSS);
    for (const directive of directivesToCheck) {
        const values = parsedCsp.directives[directive] || [];
        for (const value of values) {
            if (URL_SCHEMES_CAUSING_XSS.includes(value)) {
                violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.PLAIN_URL_SCHEMES, value + ' URI in ' + directive + ' allows the execution of ' +
                    'unsafe scripts.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.HIGH, directive, value));
            }
        }
    }
    return violations;
}
/**
 * Checks if csp contains wildcards in sensitive directives.
 * Findings of this check have a high severity and are FP free.
 *
 * Example policy where this check would trigger:
 *  script-src *
 *
 * @param parsedCsp Parsed CSP.
 */
function checkWildcards(parsedCsp) {
    const violations = [];
    const directivesToCheck = parsedCsp.getEffectiveDirectives(DIRECTIVES_CAUSING_XSS);
    for (const directive of directivesToCheck) {
        const values = parsedCsp.directives[directive] || [];
        for (const value of values) {
            const url = _utils_js__WEBPACK_IMPORTED_MODULE_5__.getSchemeFreeUrl(value);
            if (url === '*') {
                violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.PLAIN_WILDCARD, directive + ` should not allow '*' as source`, _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.HIGH, directive, value));
                continue;
            }
        }
    }
    return violations;
}
/**
 * Checks if object-src is restricted to none either directly or via a
 * default-src.
 */
function checkMissingObjectSrcDirective(parsedCsp) {
    let objectRestrictions = [];
    if (_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.OBJECT_SRC in parsedCsp.directives) {
        objectRestrictions = parsedCsp.directives[_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.OBJECT_SRC];
    }
    else if (_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.DEFAULT_SRC in parsedCsp.directives) {
        objectRestrictions = parsedCsp.directives[_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.DEFAULT_SRC];
    }
    if (objectRestrictions !== undefined && objectRestrictions.length >= 1) {
        return [];
    }
    return [new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.MISSING_DIRECTIVES, `Missing object-src allows the injection of plugins which can execute JavaScript. Can you set it to 'none'?`, _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.HIGH, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.OBJECT_SRC)];
}
/**
 * Checks if script-src is restricted either directly or via a default-src.
 */
function checkMissingScriptSrcDirective(parsedCsp) {
    if (_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.SCRIPT_SRC in parsedCsp.directives ||
        _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.DEFAULT_SRC in parsedCsp.directives) {
        return [];
    }
    return [new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.MISSING_DIRECTIVES, 'script-src directive is missing.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.HIGH, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.SCRIPT_SRC)];
}
/**
 * Checks if the base-uri needs to be restricted and if so, whether it has been
 * restricted.
 */
function checkMissingBaseUriDirective(parsedCsp) {
    return checkMultipleMissingBaseUriDirective([parsedCsp]);
}
/**
 * Checks if the base-uri needs to be restricted and if so, whether it has been
 * restricted.
 */
function checkMultipleMissingBaseUriDirective(parsedCsps) {
    // base-uri can be used to bypass nonce based CSPs and hash based CSPs that
    // use strict dynamic
    const needsBaseUri = (csp) => (csp.policyHasScriptNonces() ||
        (csp.policyHasScriptHashes() && csp.policyHasStrictDynamic()));
    const hasBaseUri = (csp) => _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.BASE_URI in csp.directives;
    if (parsedCsps.some(needsBaseUri) && !parsedCsps.some(hasBaseUri)) {
        const description = 'Missing base-uri allows the injection of base tags. ' +
            'They can be used to set the base URL for all relative (script) ' +
            'URLs to an attacker controlled domain. ' +
            `Can you set it to 'none' or 'self'?`;
        return [new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.MISSING_DIRECTIVES, description, _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.HIGH, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.BASE_URI)];
    }
    return [];
}
/**
 * Checks if all necessary directives for preventing XSS are set.
 * Findings of this check have a high severity and are FP free.
 *
 * Example policy where this check would trigger:
 *  script-src 'none'
 *
 * @param parsedCsp Parsed CSP.
 */
function checkMissingDirectives(parsedCsp) {
    return [
        ...checkMissingObjectSrcDirective(parsedCsp),
        ...checkMissingScriptSrcDirective(parsedCsp),
        ...checkMissingBaseUriDirective(parsedCsp),
    ];
}
/**
 * Checks if allowlisted origins are bypassable by JSONP/Angular endpoints.
 * High severity findings of this check are FP free.
 *
 * Example policy where this check would trigger:
 *  default-src 'none'; script-src www.google.com
 *
 * @param parsedCsp Parsed CSP.
 */
function checkScriptAllowlistBypass(parsedCsp) {
    const violations = [];
    const effectiveScriptSrcDirective = parsedCsp.getEffectiveDirective(_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.SCRIPT_SRC);
    const scriptSrcValues = parsedCsp.directives[effectiveScriptSrcDirective] || [];
    if (scriptSrcValues.includes(_csp_js__WEBPACK_IMPORTED_MODULE_3__.Keyword.NONE)) {
        return violations;
    }
    for (const value of scriptSrcValues) {
        if (value === _csp_js__WEBPACK_IMPORTED_MODULE_3__.Keyword.SELF) {
            violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.SCRIPT_ALLOWLIST_BYPASS, `'self' can be problematic if you host JSONP, AngularJS or user ` +
                'uploaded files.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.MEDIUM_MAYBE, effectiveScriptSrcDirective, value));
            continue;
        }
        // Ignore keywords, nonces and hashes (they start with a single quote).
        if (value.startsWith('\'')) {
            continue;
        }
        // Ignore standalone schemes and things that don't look like URLs (no dot).
        if (_csp_js__WEBPACK_IMPORTED_MODULE_3__.isUrlScheme(value) || value.indexOf('.') === -1) {
            continue;
        }
        const url = '//' + _utils_js__WEBPACK_IMPORTED_MODULE_5__.getSchemeFreeUrl(value);
        const angularBypass = _utils_js__WEBPACK_IMPORTED_MODULE_5__.matchWildcardUrls(url, _allowlist_bypasses_angular_js__WEBPACK_IMPORTED_MODULE_0__.URLS);
        let jsonpBypass = _utils_js__WEBPACK_IMPORTED_MODULE_5__.matchWildcardUrls(url, _allowlist_bypasses_jsonp_js__WEBPACK_IMPORTED_MODULE_2__.URLS);
        // Some JSONP bypasses only work in presence of unsafe-eval.
        if (jsonpBypass) {
            const evalRequired = _allowlist_bypasses_jsonp_js__WEBPACK_IMPORTED_MODULE_2__.NEEDS_EVAL.includes(jsonpBypass.hostname);
            const evalPresent = scriptSrcValues.includes(_csp_js__WEBPACK_IMPORTED_MODULE_3__.Keyword.UNSAFE_EVAL);
            if (evalRequired && !evalPresent) {
                jsonpBypass = null;
            }
        }
        if (jsonpBypass || angularBypass) {
            let bypassDomain = '';
            let bypassTxt = '';
            if (jsonpBypass) {
                bypassDomain = jsonpBypass.hostname;
                bypassTxt = ' JSONP endpoints';
            }
            if (angularBypass) {
                bypassDomain = angularBypass.hostname;
                bypassTxt += (bypassTxt.trim() === '') ? '' : ' and';
                bypassTxt += ' Angular libraries';
            }
            violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.SCRIPT_ALLOWLIST_BYPASS, bypassDomain + ' is known to host' + bypassTxt +
                ' which allow to bypass this CSP.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.HIGH, effectiveScriptSrcDirective, value));
        }
        else {
            violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.SCRIPT_ALLOWLIST_BYPASS, `No bypass found; make sure that this URL doesn't serve JSONP ` +
                'replies or Angular libraries.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.MEDIUM_MAYBE, effectiveScriptSrcDirective, value));
        }
    }
    return violations;
}
/**
 * Checks if allowlisted object-src origins are bypassable.
 * Findings of this check have a high severity and are FP free.
 *
 * Example policy where this check would trigger:
 *  default-src 'none'; object-src ajax.googleapis.com
 *
 * @param parsedCsp Parsed CSP.
 */
function checkFlashObjectAllowlistBypass(parsedCsp) {
    const violations = [];
    const effectiveObjectSrcDirective = parsedCsp.getEffectiveDirective(_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.OBJECT_SRC);
    const objectSrcValues = parsedCsp.directives[effectiveObjectSrcDirective] || [];
    // If flash is not allowed in plugin-types, continue.
    const pluginTypes = parsedCsp.directives[_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.PLUGIN_TYPES];
    if (pluginTypes && !pluginTypes.includes('application/x-shockwave-flash')) {
        return [];
    }
    for (const value of objectSrcValues) {
        // Nothing to do here if 'none'.
        if (value === _csp_js__WEBPACK_IMPORTED_MODULE_3__.Keyword.NONE) {
            return [];
        }
        const url = '//' + _utils_js__WEBPACK_IMPORTED_MODULE_5__.getSchemeFreeUrl(value);
        const flashBypass = _utils_js__WEBPACK_IMPORTED_MODULE_5__.matchWildcardUrls(url, _allowlist_bypasses_flash_js__WEBPACK_IMPORTED_MODULE_1__.URLS);
        if (flashBypass) {
            violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.OBJECT_ALLOWLIST_BYPASS, flashBypass.hostname +
                ' is known to host Flash files which allow to bypass this CSP.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.HIGH, effectiveObjectSrcDirective, value));
        }
        else if (effectiveObjectSrcDirective === _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.OBJECT_SRC) {
            violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.OBJECT_ALLOWLIST_BYPASS, `Can you restrict object-src to 'none' only?`, _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.MEDIUM_MAYBE, effectiveObjectSrcDirective, value));
        }
    }
    return violations;
}
/**
 * Returns whether the given string "looks" like an IP address. This function
 * only uses basic heuristics and does not accept all valid IPs nor reject all
 * invalid IPs.
 */
function looksLikeIpAddress(maybeIp) {
    if (maybeIp.startsWith('[') && maybeIp.endsWith(']')) {
        // Looks like an IPv6 address and not a hostname (though it may be some
        // nonsense like `[foo]`)
        return true;
    }
    if (/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/.test(maybeIp)) {
        // Looks like an IPv4 address (though it may be something like
        // `500.600.700.800`
        return true;
    }
    // Won't match IP addresses encoded in other manners (eg octal or
    // decimal)
    return false;
}
/**
 * Checks if csp contains IP addresses.
 * Findings of this check are informal only and are FP free.
 *
 * Example policy where this check would trigger:
 *  script-src 127.0.0.1
 *
 * @param parsedCsp Parsed CSP.
 */
function checkIpSource(parsedCsp) {
    const violations = [];
    // Function for checking if directive values contain IP addresses.
    const checkIp = (directive, directiveValues) => {
        for (const value of directiveValues) {
            const host = _utils_js__WEBPACK_IMPORTED_MODULE_5__.getHostname(value);
            if (looksLikeIpAddress(host)) {
                // Check if localhost.
                // See 4.8 in https://www.w3.org/TR/CSP2/#match-source-expression
                if (host === '127.0.0.1') {
                    violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.IP_SOURCE, directive + ' directive allows localhost as source. ' +
                        'Please make sure to remove this in production environments.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.INFO, directive, value));
                }
                else {
                    violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.IP_SOURCE, directive + ' directive has an IP-Address as source: ' + host +
                        ' (will be ignored by browsers!). ', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.INFO, directive, value));
                }
            }
        }
    };
    // Apply check to values of all directives.
    _utils_js__WEBPACK_IMPORTED_MODULE_5__.applyCheckFunktionToDirectives(parsedCsp, checkIp);
    return violations;
}
/**
 * Checks if csp contains directives that are deprecated in CSP3.
 * Findings of this check are informal only and are FP free.
 *
 * Example policy where this check would trigger:
 *  report-uri foo.bar/csp
 *
 * @param parsedCsp Parsed CSP.
 */
function checkDeprecatedDirective(parsedCsp) {
    const violations = [];
    // More details: https://www.chromestatus.com/feature/5769374145183744
    if (_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.REFLECTED_XSS in parsedCsp.directives) {
        violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.DEPRECATED_DIRECTIVE, 'reflected-xss is deprecated since CSP2. ' +
            'Please, use the X-XSS-Protection header instead.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.INFO, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.REFLECTED_XSS));
    }
    // More details: https://www.chromestatus.com/feature/5680800376815616
    if (_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.REFERRER in parsedCsp.directives) {
        violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.DEPRECATED_DIRECTIVE, 'referrer is deprecated since CSP2. ' +
            'Please, use the Referrer-Policy header instead.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.INFO, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.REFERRER));
    }
    // More details: https://github.com/w3c/webappsec-csp/pull/327
    if (_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.DISOWN_OPENER in parsedCsp.directives) {
        violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.DEPRECATED_DIRECTIVE, 'disown-opener is deprecated since CSP3. ' +
            'Please, use the Cross Origin Opener Policy header instead.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.INFO, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.DISOWN_OPENER));
    }
    return violations;
}
/**
 * Checks if csp nonce is at least 8 characters long.
 * Findings of this check are of medium severity and are FP free.
 *
 * Example policy where this check would trigger:
 *  script-src 'nonce-short'
 *
 * @param parsedCsp Parsed CSP.
 */
function checkNonceLength(parsedCsp) {
    const noncePattern = new RegExp('^\'nonce-(.+)\'$');
    const violations = [];
    _utils_js__WEBPACK_IMPORTED_MODULE_5__.applyCheckFunktionToDirectives(parsedCsp, (directive, directiveValues) => {
        for (const value of directiveValues) {
            const match = value.match(noncePattern);
            if (!match) {
                continue;
            }
            // Not a nonce.
            const nonceValue = match[1];
            if (nonceValue.length < 8) {
                violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.NONCE_LENGTH, 'Nonces should be at least 8 characters long.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.MEDIUM, directive, value));
            }
            if (!_csp_js__WEBPACK_IMPORTED_MODULE_3__.isNonce(value, true)) {
                violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.NONCE_CHARSET, 'Nonces should only use the base64 charset.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.INFO, directive, value));
            }
        }
    });
    return violations;
}
/**
 * Checks if CSP allows sourcing from http://
 * Findings of this check are of medium severity and are FP free.
 *
 * Example policy where this check would trigger:
 *  report-uri http://foo.bar/csp
 *
 * @param parsedCsp Parsed CSP.
 */
function checkSrcHttp(parsedCsp) {
    const violations = [];
    _utils_js__WEBPACK_IMPORTED_MODULE_5__.applyCheckFunktionToDirectives(parsedCsp, (directive, directiveValues) => {
        for (const value of directiveValues) {
            const description = directive === _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.REPORT_URI ?
                'Use HTTPS to send violation reports securely.' :
                'Allow only resources downloaded over HTTPS.';
            if (value.startsWith('http://')) {
                violations.push(new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.SRC_HTTP, description, _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.MEDIUM, directive, value));
            }
        }
    });
    return violations;
}
/**
 * Checks if the policy has configured reporting in a robust manner.
 */
function checkHasConfiguredReporting(parsedCsp) {
    const reportUriValues = parsedCsp.directives[_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.REPORT_URI] || [];
    if (reportUriValues.length > 0) {
        return [];
    }
    const reportToValues = parsedCsp.directives[_csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.REPORT_TO] || [];
    if (reportToValues.length > 0) {
        return [new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.REPORT_TO_ONLY, `This CSP policy only provides a reporting destination via the 'report-to' directive. This directive is only supported in Chromium-based browsers so it is recommended to also use a 'report-uri' directive.`, _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.INFO, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.REPORT_TO)];
    }
    return [new _finding_js__WEBPACK_IMPORTED_MODULE_4__.Finding(_finding_js__WEBPACK_IMPORTED_MODULE_4__.Type.REPORTING_DESTINATION_MISSING, 'This CSP policy does not configure a reporting destination. This makes it difficult to maintain the CSP policy over time and monitor for any breakages.', _finding_js__WEBPACK_IMPORTED_MODULE_4__.Severity.INFO, _csp_js__WEBPACK_IMPORTED_MODULE_3__.Directive.REPORT_URI)];
}
//# sourceMappingURL=security_checks.js.map

/***/ }),

/***/ "./third_party/csp_evaluator/package/utils.js":
/*!****************************************************!*\
  !*** ./third_party/csp_evaluator/package/utils.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   applyCheckFunktionToDirectives: () => (/* binding */ applyCheckFunktionToDirectives),
/* harmony export */   getHostname: () => (/* binding */ getHostname),
/* harmony export */   getSchemeFreeUrl: () => (/* binding */ getSchemeFreeUrl),
/* harmony export */   matchWildcardUrls: () => (/* binding */ matchWildcardUrls)
/* harmony export */ });
/**
 * @fileoverview Utils for CSP evaluator.
 * @author lwe@google.com (Lukas Weichselbaum)
 *
 * @license
 * Copyright 2016 Google Inc. All rights reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * Removes scheme from url.
 * @param url Url.
 * @return url without scheme.
 */
function getSchemeFreeUrl(url) {
    url = url.replace(/^\w[+\w.-]*:\/\//i, '');
    // Remove URL scheme.
    url = url.replace(/^\/\//, '');
    // Remove protocol agnostic "//"
    return url;
}
/**
 * Get the hostname from the given url string in a way that supports schemeless
 * URLs and wildcards (aka `*`) in hostnames
 */
function getHostname(url) {
    const hostname = new URL('https://' +
        getSchemeFreeUrl(url)
            .replace(':*', '') // Remove wildcard port
            .replace('*', 'wildcard_placeholder'))
        .hostname.replace('wildcard_placeholder', '*');
    // Some browsers strip the brackets from IPv6 addresses when you access the
    // hostname. If the scheme free url starts with something that vaguely looks
    // like an IPv6 address and our parsed hostname doesn't have the brackets,
    // then we add them back to work around this
    const ipv6Regex = /^\[[\d:]+\]/;
    if (getSchemeFreeUrl(url).match(ipv6Regex) && !hostname.match(ipv6Regex)) {
        return '[' + hostname + ']';
    }
    return hostname;
}
function setScheme(u) {
    if (u.startsWith('//')) {
        return u.replace('//', 'https://');
    }
    return u;
}
/**
 * Searches for allowlisted CSP origin (URL with wildcards) in list of urls.
 * @param cspUrlString The allowlisted CSP origin. Can contain domain and
 *   path wildcards.
 * @param listOfUrlStrings List of urls to search in.
 * @return First match found in url list, null otherwise.
 */
function matchWildcardUrls(cspUrlString, listOfUrlStrings) {
    // non-Chromium browsers don't support wildcards in domain names. We work
    // around this by replacing the wildcard with `wildcard_placeholder` before
    // parsing the domain and using that as a magic string. This magic string is
    // encapsulated in this function such that callers of this function do not
    // have to worry about this detail.
    const cspUrl = new URL(setScheme(cspUrlString
        .replace(':*', '') // Remove wildcard port
        .replace('*', 'wildcard_placeholder')));
    const listOfUrls = listOfUrlStrings.map(u => new URL(setScheme(u)));
    const host = cspUrl.hostname.toLowerCase();
    const hostHasWildcard = host.startsWith('wildcard_placeholder.');
    const wildcardFreeHost = host.replace(/^\wildcard_placeholder/i, '');
    const path = cspUrl.pathname;
    const hasPath = path !== '/';
    for (const url of listOfUrls) {
        const domain = url.hostname;
        if (!domain.endsWith(wildcardFreeHost)) {
            // Domains don't match.
            continue;
        }
        // If the host has no subdomain wildcard and doesn't match, continue.
        if (!hostHasWildcard && host !== domain) {
            continue;
        }
        // If the allowlisted url has a path, check if one of the url paths
        // match.
        if (hasPath) {
            // https://www.w3.org/TR/CSP2/#source-list-path-patching
            if (path.endsWith('/')) {
                if (!url.pathname.startsWith(path)) {
                    continue;
                }
            }
            else {
                if (url.pathname !== path) {
                    // Path doesn't match.
                    continue;
                }
            }
        }
        // We found a match.
        return url;
    }
    // No match was found.
    return null;
}
/**
 * Applies a check to all directive values of a csp.
 * @param parsedCsp Parsed CSP.
 * @param check The check function that
 *   should get applied on directive values.
 */
function applyCheckFunktionToDirectives(parsedCsp, check) {
    const directiveNames = Object.keys(parsedCsp.directives);
    for (const directive of directiveNames) {
        const directiveValues = parsedCsp.directives[directive];
        if (directiveValues) {
            check(directive, directiveValues);
        }
    }
}
//# sourceMappingURL=utils.js.map

/***/ })

}]);